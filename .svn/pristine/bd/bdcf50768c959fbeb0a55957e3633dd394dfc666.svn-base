<div class="card-from">
    <div class="card">
        <div class="card-header">
            <p class="mb-0">Incentive Scheme Master</p>
        </div>
        <div class="card-body">
            <form [formGroup]="incentiveSchemeMaster" [style.fontSize.px]="10">
                <div class="row">

                    <!-- For Scheme No -->
                    <div class="col-lg-2" *ngIf="display">
                        <mat-form-field appearance="outline">
                            <mat-label>Scheme No.</mat-label>
                            <input matInput placeholder="Scheme No." formControlName="schemeNo">
                        </mat-form-field>
                    </div>
                    <!-- For Scheme Type -->
                    <div class="col-lg-2">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Scheme Type</mat-label>
                            <mat-select formControlName="schemeType" required
                                (selectionChange)="selectSchemeType($event)">
                                <mat-option *ngFor="let option of dropdownSchemeTypeDomain?.result"
                                    [value]="option?.schemeType">{{option?.schemeType}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- For Date -->
                    <div class="col-lg-2">
                        <mat-form-field appearance="outline" class="w-100">
                            <input matInput [matDatepicker]="picker1" placeholder="Scheme Date"
                                formControlName="schemeDate">
                            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                            <mat-datepicker #picker1></mat-datepicker>
                        </mat-form-field>
                    </div>
                    <!-- for Reference Scheme No -->
                    <div class="col-lg-2">
                        <mat-form-field appearance="outline">
                            <mat-label>Reference Scheme No</mat-label>
                            <input matInput placeholder="Reference Scheme No" autocomplete="off" required
                                formControlName="referenceSchemeNo">
                        </mat-form-field>
                    </div>
                    <!-- for Activity No Create -->
                    <div class="col-lg-2" *ngIf="isCreate">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>Activity No.</mat-label>
                            <input matInput placeholder="Activity No." formControlName="activityNo"
                                [matAutocomplete]="autoComActivityNo"
                                [required]="incentiveSchemeMaster.controls.schemeType.value == 'BOOKING SCHEME'">
                            <mat-autocomplete #autoComActivityNo="matAutocomplete" [displayWith]="displayActivityNoFn">
                                <mat-option *ngFor="let option of autoComActivityNoDomain?.result" [value]="option">
                                    {{option?.activityNumber}}
                                </mat-option>
                            </mat-autocomplete>
                            <mat-icon matSuffix>search</mat-icon>
                        </mat-form-field>
                        <mat-error *ngIf="incentiveSchemeMaster.get('activityNo').hasError('selectFromList')">
                            Please select from list
                        </mat-error>
                    </div>
                    <!-- For Activity no View -->
                    <div class="col-lg-2" *ngIf="isView">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Activity No.</mat-label>
                            <input matInput placeholder="Activity No." formControlName="activityNo">
                        </mat-form-field>
                    </div>
                    <!--  For Status-->
                    <div class="col-lg-2 " *ngIf="display">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Status</mat-label>
                            <mat-select formControlName="status">
                                <mat-option *ngFor="let item of status" [value]="item">{{item}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- For Zone -->
                    <div class="col-lg-2">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Zone</mat-label>
                            <mat-select formControlName="zones" multiple (selectionChange)="selectionZones($event)">
                                <mat-option *ngFor="let option of dropdownZoneDomain" [value]="option">
                                    {{option?.code}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- For Region -->
                    <div class="col-lg-2" *ngIf="isCreate">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Region</mat-label>
                            <mat-select formControlName="regions" multiple
                                (selectionChange)="selectionRegions($event.value)">
                                <mat-option *ngFor="let option of dropdownRegionDomain?.result"
                                    [value]="option">{{option?.region}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="col-lg-2" *ngIf="isView">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Region.</mat-label>
                            <input matInput placeholder="Region" formControlName="regions">
                        </mat-form-field>
                    </div>
                    <!-- For Product -->
                    <div class="col-lg-2">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Product</mat-label>
                            <mat-select formControlName="product" multiple
                                (selectionChange)="selectionProduct($event.value)">
                                <mat-option *ngFor="let option of dropdownProductDomain?.result" [value]="option">
                                    {{option?.product}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- For Series -->
                    <div class="col-lg-2">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Series</mat-label>
                            <mat-select formControlName="series" multiple
                                (selectionChange)="selectionSeries($event.value)">
                                <mat-option *ngFor="let item of uniqueSeries" [value]="item">
                                    {{item?.series}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- For Model -->
                    <div class="col-lg-2">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Model</mat-label>
                            <mat-select formControlName="model" multiple
                                (selectionChange)="selectionModel($event.value)">
                                <mat-option *ngFor="let option of uniqueModel" [value]="option">
                                    {{option?.model}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- For Sub Model -->
                    <div class="col-lg-2">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Sub Model</mat-label>
                            <mat-select formControlName="submodels" multiple
                                (selectionChange)="selectionSubmodel($event.value)">
                                <mat-option *ngFor="let option of uniqueSubModel" [value]="option">
                                    {{option?.subModel}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- For Varient -->
                    <div class="col-lg-2">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Variant</mat-label>
                            <mat-select formControlName="variant" multiple
                                (selectionChange)="selectionVariants($event.value)">
                                <mat-option *ngFor="let option of uniqueVariant" [value]="option">
                                    {{option?.variant}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- For Item No Create -->
                    <div class="col-lg-2" *ngIf="isCreate">
                        <mat-form-field appearance="outline" class="w-100">
                            <mat-label>Item No</mat-label>
                            <mat-select formControlName="itemNo" multiple
                                (selectionChange)="selectedItemNo($event.value)">
                                <mat-option *ngFor="let option of  autoComItemNoDomain?.result" [value]="option">
                                    {{option?.itemNo}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <!-- <div class="col-lg-2" *ngIf="isCreate">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>Item No.</mat-label>
                            <input matInput placeholder="Item No." formControlName="itemNo" [matAutocomplete]="autoComItemNo" >
                            <mat-autocomplete #autoComItemNo="matAutocomplete" [displayWith]="displayItemNoFn">
                                <mat-option *ngFor="let user of autoComItemNoDomain?.result" [value]="selectedUsers">
                                    <div (click)="optionClicked($event, user)">
                                        <mat-checkbox [checked]="user.selectedItem" (change)="toggleSelection(user)" (click)="$event.stopPropagation()">
                                          
                                            {{user.itemNo}}
                                        </mat-checkbox>
                                    </div>
                                </mat-option>
                            </mat-autocomplete>
                            <mat-icon matSuffix>search</mat-icon>
                        </mat-form-field>
                    </div> -->


                    <!-- for Item No View -->
                    <div class="col-lg-2" *ngIf="isView">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>Item No.</mat-label>
                            <input matInput placeholder="Item No." formControlName="itemNo">
                            <mat-icon matSuffix>search</mat-icon>
                        </mat-form-field>
                    </div>
                    <!-- For Valid from Date -->
                    <div class="col-lg-2">
                        <mat-form-field class="w-100">
                            <input matInput [min]="todayDate" [matDatepicker]="picker3" placeholder="Valid From"
                                required formControlName="validFrom" readonly (click)="picker3.open()"
                                (dateChange)="fromDateChange($event)">
                            <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                            <mat-datepicker #picker3></mat-datepicker>
                        </mat-form-field>
                    </div>
                    <!-- For Valid To date -->
                    <div class="col-lg-2">
                        <mat-form-field class="w-100">
                            <input matInput [min]="minDate" [matDatepicker]="picker2" placeholder="Valid To" required
                                formControlName="validTo" readonly (click)="picker2.open()">
                            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                            <mat-datepicker #picker2></mat-datepicker>
                        </mat-form-field>
                    </div>

                    <div class="col-lg-2">
                        <div class="form-check mt-2">
                            <mat-checkbox formControlName="maxQty" [checked]="maximumQty" color="basic"
                                style="font-size: 12px;margin-left: -20px;" [labelPosition]="labelPosition"
                                (change)="selectMaximumQty($event)">Maximum Qty.
                            </mat-checkbox>
                        </div>
                    </div>
                    <div class="col-lg-2">
                        <div class="form-check mt-2">
                            <mat-checkbox formControlName="claimAttachReq" [checked]="claimAttachmentTrueOrFalse"
                                (change)="checkValidationForUpload($event)" color="basic"
                                style="font-size: 12px;margin-left: -20px;" [labelPosition]="labelPosition">Attachment
                                REQ For Claim</mat-checkbox>
                        </div>
                    </div>
                    <div class="col-lg-2">
                        <div class="form-check mt-2">
                            <mat-checkbox formControlName="exceedQty" [checked]="claimForProceed" color="basic"
                                style="font-size: 12px;margin-left: -20px;" [labelPosition]="labelPosition">Incentive
                                Allowed For
                                Exceeded Qty.</mat-checkbox>
                        </div>
                    </div>
                </div>
            </form>
            <!-- for download and Upload Excel -->

            <div class="text-center" *ngIf="isCreate">
                <input hidden type="file" #uploader accept=".xlsx" (change)="uploadExcelFileChanges($event)" />
                <button type="file" class="btn btn_primary pl-3 pr-3 mr-3" (click)="uploader.click()"> Excel Upload
                </button>

                <button type="file" class="btn btn_primary pl-3 pr-3" (click)="downloadTemplate()"> Download Template
                </button>
            </div>

            <div class="card-from mt-2" *ngIf="showUploadFile">
                <div class="card" style="border: 1px solid #45afaf;">
                    <div class="card-header" style="background-color: #45afaf;border: 1px solid #45afaf;">
                        <p class="mb-0" style="font-size: 13px;">FILE ATTACHMENT</p>
                    </div>
                    <div class="card-body">

                        <div class="row" [style.fontSize.px]="14">
                            <div class="col-lg-6">
                                <div class="d-flex bd-highlight">

                                    <div class="w-50 flex-fill bd-highlight">
                                        <div class="input-group">
                                            <div class="custom-file">
                                                <input type="file"  (change)="fileSelectionChanges($event)"
                                                    [formControl]="file" class="custom-file-input" name="image"
                                                    accept="image/x-png,image/jpeg">
                                                <label class="custom-file-label">Choose file</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="w-25"></div>
                                </div>
                            </div>

                        </div>
                        <div class="row mt-2 text-center">
                            <div class="col-md-2 d-flex justify-content-around" *ngFor="let file of files">
                                <div class="card file-preview-card">
                                    <label class="custom-preview-label"> {{file.file.name}} </label>
                                    <img [src]="file.previewUrl" height="120" width="185" />
                                    <div class="card-body">
                                        <i style="color: #45afaf; cursor: pointer;" class="material-icons"
                                            (click)="deleteImage(file.id)">delete</i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2 text-center" *ngIf="isView">
                            <div class="col-md-2 d-flex justify-content-around"
                                *ngFor="let file of claimAttachmentPhoto">
                                <div class="card file-preview-card">
                                    <label> {{file.fileName}} </label>
                                    <img src="{{fileStaticPath}}/{{file.fileName}}" height="120" width="185" />
                                    <div class="card-body">
                                        <a href="{{fileStaticPath}}/{{file.fileName}}" download>
                                            <i style="color: #45afaf;" class="material-icons">cloud_download</i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="card-from mt-2" *ngIf="isView && claimAttachmentTrueOrFalse">
                <div class="card" style="border: 1px solid #45afaf;">
                    <div class="card-header" style="background-color: #45afaf;border: 1px solid #45afaf;">
                        <p class="mb-0" style="font-size: 13px;">VIEW FILE ATTACHMENT</p>
                    </div>
                    <div class="card-body">

                        <!-- <div class="row" [style.fontSize.px]="14">
                            <div class="col-lg-6">
                                <div class="d-flex bd-highlight">
                                   
                                    <div class="w-50 flex-fill bd-highlight">
                                        <div class="input-group">
                                            <div class="custom-file">
                                                <input type="file" (change)="fileSelectionChanges($event)"[formControl]="file" class="custom-file-input" name="image" accept="image/x-png,image/jpeg">
                                                <label class="custom-file-label">Choose file</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="w-25"></div>
                                </div>
                            </div>
            
                        </div>
                         <div class="row mt-2 text-center">
                            <div class="col-md-2 d-flex justify-content-around" *ngFor="let file of files">
                              <div class="card file-preview-card">
                                <label class="custom-preview-label"> {{file.file.name}} </label>
                                <img [src]="file.previewUrl" height="120" width="185" />
                                <div class="card-body">
                                  <i style="color: #45afaf; cursor: pointer;" class="material-icons" (click)="deleteImage(file.id)">delete</i>
                                </div>
                              </div>
                            </div>
                        </div>  -->
                        <div class="row mt-2 text-center">
                            <div class="col-md-2 d-flex justify-content-around">
                                <div class="card file-preview-card">
                                    <!-- <label> {{file.fileName}} </label> -->
                                    <img src="{{fileStaticPath}}/{{claimAttachmentPhoto}}" height="120" width="185" />
                                    <div class="card-body">
                                        <a href="{{fileStaticPath}}/{{claimAttachmentPhoto}}" download>
                                            <i style="color: #45afaf;" class="material-icons">cloud_download</i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- FOr INcentive Details -->
            <div class="card-from mt-2">
                <div class="card" style="border: 1px solid #45afaf;">
                    <div class="card-header" style="background-color: #45afaf;
                  border: 1px solid #45afaf;">
                        <p class="mb-0" style="font-size: 13px;">Incentive Details</p>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered table-sm">
                                <thead class="thead-light">
                                    <tr *ngIf="showEmployeeDetails || viewShowForm">
                                        <td class="border-0" colspan="4"></td>
                                        <td class="font-weight-bold" colspan="2">Target 1</td>
                                        <td class="font-weight-bold" colspan="2">Target 2</td>
                                        <td class="font-weight-bold" colspan="2">Target 3</td>
                                        <td class="font-weight-bold" colspan="2">Target 4</td>
                                        <td class="font-weight-bold" colspan="2">Target 5</td>
                                    </tr>
                                    <tr *ngIf="!showEmployeeDetails && !viewShowForm">
                                        <td class="border-0" colspan="2"></td>
                                        <td class="font-weight-bold" colspan="2">Target 1</td>
                                        <td class="font-weight-bold" colspan="2">Target 2</td>
                                        <td class="font-weight-bold" colspan="2">Target 3</td>
                                        <td class="font-weight-bold" colspan="2">Target 4</td>
                                        <td class="font-weight-bold" colspan="2">Target 5</td>
                                    </tr>
                                    
                                    
                                    
                                    <tr>
                                        <th scope="col" >Dealer Code</th>
                                        <th scope="col" >Dealer Name</th>
                                        <th scope="col" *ngIf="showEmployeeDetails ||viewShowForm">
                                            Employee Code</th>
                                        <th scope="col" *ngIf="showEmployeeDetails ||viewShowForm">
                                            Employee Name</th>
                                        <th scope="col">Qty</th>
                                        <th scope="col">Incentive/Qty</th>
                                        <th scope="col">Qty</th>
                                        <th scope="col">Incentive/Qty</th>
                                        <th scope="col">Qty</th>
                                        <th scope="col">Incentive/Qty</th>
                                        <th scope="col">Qty</th>
                                        <th scope="col">Incentive/Qty</th>
                                        <th scope="col">Qty</th>
                                        <th scope="col">Incentive/Qty</th>
                                        <th scope="col" *ngIf="isMaximumQtySelected || maximumQty">Maximum Qty</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let row of incentiveSchemeDetails;let ind = index;">
                                        <td [ngClass]="row.errorMsg?'red':'black'">
                                            {{row.dealerCode}}</td>
                                        <td>
                                            {{row.dealerName}}</td>
                                        <td [ngClass]="row.errorMsg?'red':'black'"
                                        *ngIf="showEmployeeDetails ||viewShowForm">
                                            {{row.dealerEmployeeCode}}</td>
                                        <td *ngIf="showEmployeeDetails ||viewShowForm">
                                            {{row.dealerEmployeeName}}</td>
                                        <td>{{row.t1Quantity}}</td>
                                        <td>{{row.t1IncentivePerQuantity}}</td>
                                        <td>{{row.t2Quantity}}</td>
                                        <td>{{row.t2IncentivePerQuantity}}</td>
                                        <td>{{row.t3Quantity}}</td>
                                        <td>{{row.t3IncentivePerQuantity}}</td>
                                        <td>{{row.t4Quantity}}</td>
                                        <td>{{row.t4IncentivePerQuantity}}</td>
                                        <td>{{row.t5Quantity}}</td>
                                        <td>{{row.t5IncentivePerQuantity}}</td>
                                        <td *ngIf="isMaximumQtySelected || maximumQty">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Maximum Qty</mat-label>
                                                <input matInput  [disabled]="!isCreate" [(ngModel)]="row.maximumQuantity" (keypress)="validateInput($event)"  placeholder="Maximum Qty">
                                               <!-- <span>{{row.maximumQty}}</span> -->
                                              </mat-form-field>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class=" text-center mt-2 ">
                <button type="button" class="btn btn_primary pl-3 pr-3 ml-3" *ngIf="!isView" (click)="validateForm()">
                    Submit
                </button>
                <button type="button" class="btn btn_primary pl-3 pr-3 ml-3" *ngIf="isEdit" (click)="validateForm()">
                    Update
                </button>
                <button type="button" class="btn btn_secondary pl-3 pr-3 ml-3" *ngIf="!isView" (click)="clearForm()">
                    Clear
                </button>
                <button type="button" class="btn btn_secondary pl-3 pr-3 ml-3" *ngIf="isView" (click)="exit()"> Exit
                </button>
            </div>
        </div>
    </div>
</div>