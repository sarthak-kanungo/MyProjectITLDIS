

<div class=" text-right" *ngIf="!isView && !hideLinks">
  <a class="pr-3" style="color: #00a8a9;font-size: 15px;"  (click)="downloadTemplate()"><u>Download Template</u></a>
  <a class="pr-2" style="color: #00a8a9;font-size: 15px;"  (click)="uploadExcel()"><u>Excel Upload</u></a>
</div>

<div class="card-from mt-2">
    <div class="card" style="border: 1px solid #45afaf;">
        <div class="card-header" style="background-color: #45afaf;
          border: 1px solid #45afaf;">
            <p class="mb-0" style="font-size: 13px;">Item Details</p>
        </div>
        <div class="card-body">
            <form>
                <div>
                    <div class="table-responsive mt-1">
                        <table class="table table-bordered table-sm">
                            <thead class="thead-light">
                                <tr>
                                    <th scope="col" class="w_50" *ngIf="!isView"></th>
                                    <th scope="col" class="w_120">Item No.</th>
                                    <th scope="col" class="w_250">Item Description</th>
                                    <th scope="col" class="w_100">{{isView ? 'UOM' :'HSN'}}</th>
                                    <th scope="col" class="w_100">Stock</th>
                                    <th scope="col" class="w_100">Order Qty</th>
                                    <th scope="col" class="w_100" *ngIf="isView">Issue Qty</th>
                                    <th scope="col" class="w_100" *ngIf="isView">Back Qty</th>
                                    <th scope="col" class="w_100">Unit Price</th>
                                    <th scope="col" class="w_100">Amount</th>
                                    <th scope="col" class="w_100">Discount %</th>
                                    <th scope="col" class="w_120">Discount Amount</th>
                                    <th scope="col" class="w_100">Net Amount</th>
                                    <th scope="col" class="w_100">CGST %</th>
                                    <th scope="col" class="w_100">CGST Amount</th>
                                    <th scope="col" class="w_100">SGST %</th>
                                    <th scope="col" class="w_100">SGST Amount</th>
                                    <th scope="col" class="w_100">IGST %</th>
                                    <th scope="col" class="w_100">IGST Amount</th>
                                    <th scope="col" class="w_250" *ngIf="isView">Remark</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr #trRef *ngFor="let tableRowFg of itemDetailTable['controls']; let i = index"
                                    [attr.aria-itemNumber]="tableRowFg.get('itemNo').value">
                                    <td *ngIf="!isView">
                                        <mat-checkbox color="basic" class="form-control form-control-sm"
                                            [formControl]="tableRowFg.get('isSelected')" [checked]></mat-checkbox>
                                    </td>
                                    <!-- <td>{{getTableSrNo(i)}}</td> -->
                                    <td>
                                        <mat-form-field appearance="outline" class="w-100" [style.fontSize.px]="10">
                                            <mat-label>Item Number</mat-label>
                                            <input matInput placeholder="Item Number"
                                                [formControl]="tableRowFg.get('itemNo')"
                                                [matAutocomplete]="autoItemNumber">
                                            <mat-autocomplete #autoItemNumber="matAutocomplete"
                                                (optionSelected)="optionSelectedItem($event, tableRowFg)"
                                                [displayWith]="displayFnItemNumber" [panelWidth]="300">
                                                <mat-option *ngFor="let option of (itemNumberList$| async)"
                                                    [value]="option">
                                                    {{option?.value}}
                                                </mat-option>
                                            </mat-autocomplete>
                                            <mat-icon matSuffix>search</mat-icon>
                                            <mat-error *ngIf="tableRowFg.get('itemNo').hasError('selectFromList')">
                                                Please select from list</mat-error>
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="Item Description"
                                                [formControl]="tableRowFg.get('itemDescription')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                    	<mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="HSN Code"
                                                [formControl]="(tableRowFg.get('hsnCode') || tableRowFg.get('uom'))">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="Available Stock"
                                                [formControl]="tableRowFg.get('availableStock')">
                                        </mat-form-field>
                                    </td>
                                    <td> 
                                    	<mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="Order Qty"
                                                [formControl]="tableRowFg.get('quantity')">
                                        </mat-form-field>
                                    </td>
                                    <td *ngIf="isView">
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="Issue Quantity"
                                                [formControl]="tableRowFg.get('issueQuantity')">
                                        </mat-form-field>
                                    </td>
                                    <td *ngIf="isView">
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="Back Quantity"
                                                [formControl]="tableRowFg.get('backQuantity')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="Unit Price."
                                                [formControl]="tableRowFg.get('unitPrice')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput
                                                [formControl]="tableRowFg.get('amount')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="Discount %"
                                                [formControl]="tableRowFg.get('discountPercent')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="Discount Amount"
                                                [formControl]="tableRowFg.get('discountAmount')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="Net Amount"
                                                [formControl]="tableRowFg.get('netAmount')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="CGST %"
                                                [formControl]="tableRowFg.get('cgstPercent')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="CGST Amount"
                                                [formControl]="tableRowFg.get('cgstAmount')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="SGST %"
                                                [formControl]="tableRowFg.get('sgstPercent')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="SGST Amount"
                                                [formControl]="tableRowFg.get('sgstAmount')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="IGST %"
                                                [formControl]="tableRowFg.get('igstPercent')">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput placeholder="IGST %"
                                                [formControl]="tableRowFg.get('igstAmount')">
                                        </mat-form-field>
                                    </td>
                                    <td *ngIf="isView">
                                        <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                            <input matInput
                                                [formControl]="tableRowFg.get('remark')">
                                        </mat-form-field>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </form>
            <div class=" text-center mt-2" *ngIf="!isView">
                <button type="button" class="btn btn-sm btn_primary" (click)="createNewRow()">Add Row</button>
                <button type="button" class="btn btn-sm btn_secondary ml-2" (click)="deleteRow()">Delete Row </button>
            </div>

        </div>
        <div class="col-lg-12 mt-3">
            <form [formGroup]="partsTotalForm" class="d-flex justify-content-end ">
                <table class="col-4">
                    <tr>
                        <td>SubTotal</td>
                        <td>
                            <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                <input matInput placeholder="SubTotal" formControlName="subTotal">
                            </mat-form-field>
                        </td>
                    </tr>
                    <tr>
                        <td>GST Amount</td>
                        <td>
                            <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                <input matInput placeholder="GST Amount" formControlName="gstAmount">
                            </mat-form-field>
                        </td>
                    </tr>
                    <tr>
                        <td>Total Invoice Amount</td>
                        <td>
                            <mat-form-field class="w-100" appearance="outline" [style.fontSize.px]="10">
                                <input matInput placeholder="Total Invoice Amount" formControlName="totalInvoiceAmount">
                            </mat-form-field>
                        </td>
                    </tr>
                </table>
            </form>
        </div>
    </div>
</div>